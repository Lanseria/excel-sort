import{d as e,N as a,a as l,b as t,c as s,e as n,f as o,g as d,h as r,i as u,j as i,F as p,r as c,x as f,o as m,k as y,w as x,l as h,m as _,n as k,p as v,q as N}from"./vendor.8fc8298e.js";var b=e({name:"App",components:{NUpload:a,NUploadDragger:l,NIcon:t,NText:s,NP:n,NGrid:o,NGi:d,NButton:r,NDataTable:u,NSpace:i,FileExcelOutlinedIcon:p},setup(){const e=c([]);let a={};const l=c(!1);return{columns:[{title:"卡号",key:"key"},{title:"姓名",key:"name"},{title:"部门名称",key:"deptName"},{title:"补贴类型",key:"type"},{title:"补贴金额",key:"amount"}],showJsonTable:l,dataTable:e,handleBeforeUpload:({file:t})=>{const s=new FileReader;s.onload=t=>{var s;const n=null==(s=t.target)?void 0:s.result,o=f.read(n,{type:"binary"}),d=o.Sheets[o.SheetNames[0]],r=f.utils.sheet_to_json(d,{defval:"",header:["key","name","deptName","type","amount"]});a=r.shift(),e.value=r,l.value=!0},s.readAsBinaryString(t.file)},sortByKey:()=>{e.value=m(e.value,(function(e){return Number(e.key)}))},downloadFile:()=>{const l=f.utils.book_new();e.value.unshift(a);const t=f.utils.json_to_sheet(e.value,{skipHeader:!0});return console.log(t["!ref"]),f.utils.book_append_sheet(l,t,"Results"),f.writeFile(l,"1.xls")}}}});const g={style:{"margin-bottom":"12px"}},w=v("点击或者拖动文件到该区域来上传"),B=v("请不要上传敏感数据，比如你的银行卡号和密码，信用卡号有效期和安全码"),F=v("排序"),T=v("下载");b.render=function(e,a,l,t,s,n){const o=h("FileExcelOutlinedIcon"),d=h("n-icon"),r=h("n-text"),u=h("n-p"),i=h("n-upload-dragger"),p=h("n-upload"),c=h("n-data-table"),f=h("n-gi"),m=h("n-button"),v=h("n-space"),N=h("n-grid");return _(),y(N,{cols:"8 s:8 m:8 l:8 xl:4 2xl:4","y-gap":8,responsive:"screen"},{default:x((()=>[k(f,{offset:"l:2 xl:1 2xl:1",span:"8 s:8 m:8 l:4 xl:2 2xl:2"},{default:x((()=>[e.showJsonTable?(_(),y(c,{key:1,ref:"table",columns:e.columns,data:e.dataTable,"max-height":"70vh","virtual-scroll":""},null,8,["columns","data"])):(_(),y(p,{key:0,accept:".xls","show-file-list":!1,onBeforeUpload:e.handleBeforeUpload},{default:x((()=>[k(i,null,{default:x((()=>[k("div",g,[k(d,{size:"48",depth:3},{default:x((()=>[k(o)])),_:1})]),k(r,{style:{"font-size":"16px"}},{default:x((()=>[w])),_:1}),k(u,{depth:"3",style:{margin:"8px 0 0 0"}},{default:x((()=>[B])),_:1})])),_:1})])),_:1},8,["onBeforeUpload"]))])),_:1}),k(f,{offset:"1 s:1 m:1 l:2 xl:1 2xl:1",span:"6 s:6 m:6 l:4 xl:2 2xl:2"},{default:x((()=>[k(v,null,{default:x((()=>[k(m,{type:"primary",onClick:a[1]||(a[1]=a=>e.sortByKey())},{default:x((()=>[F])),_:1}),k(m,{onClick:a[2]||(a[2]=a=>e.downloadFile())},{default:x((()=>[T])),_:1})])),_:1})])),_:1})])),_:1})},N(b).mount("#app");
