import{r as e,v as t,n as a,d as n,u as l,o as s,c as o,a as i,b as r,N as d,e as u,f as c,g as f,h as p,i as m,j as y,k as v,l as g,m as h,p as k,q as x,F as N,s as _,t as R,x as b,w,y as B,z as E,A as S,B as T,C as U}from"./vendor.c19243bb.js";function F(n={}){const{immediate:l=!0,onNeedRefresh:s,onOfflineReady:o,onRegistered:i,onRegisterError:r}=n,d=e(!1),u=e(!1);return{updateServiceWorker:function(e={}){const{immediate:n=!1,onNeedRefresh:l,onOfflineReady:s,onRegistered:o,onRegisterError:i}=e;let r,d;if("serviceWorker"in navigator){r=new t("/excel-sort/sw.js",{scope:"/excel-sort/"}),r.addEventListener("activated",(e=>{e.isUpdate||null==s||s()}));{const e=()=>{null==l||l()};r.addEventListener("waiting",e),r.addEventListener("externalwaiting",e)}r.register({immediate:n}).then((e=>{d=e,null==o||o(e)})).catch((e=>{null==i||i(e)}))}return async(e=!0)=>{e&&(null==r||r.addEventListener("controlling",(e=>{e.isUpdate&&window.location.reload()}))),d&&d.waiting&&await a(d.waiting,{type:"SKIP_WAITING"})}}({immediate:l,onNeedRefresh(){d.value=!0,null==s||s()},onOfflineReady(){u.value=!0,null==o||o()},onRegistered:i,onRegisterError:r}),offlineReady:u,needRefresh:d}}const j={key:0,class:"pwa-toast",role:"alert"},C={class:"message"},I={key:0},L={key:1};var z=n({setup(e){const{offlineReady:t,needRefresh:a,updateServiceWorker:n}=F(),d=async()=>{t.value=!1,a.value=!1};return(e,u)=>l(t)||l(a)?(s(),o("div",j,[i("div",C,[l(t)?(s(),o("span",I," 应用已经准备好离线启动 ")):(s(),o("span",L," 新的更新已经下载, 点击刷新进行更新 "))]),l(a)?(s(),o("button",{key:0,onClick:u[1]||(u[1]=e=>l(n)())},"刷新")):r("",!0),i("button",{onClick:d},"关闭")])):r("",!0)}}),O=n({name:"App",components:{NUpload:d,NUploadDragger:u,NIcon:c,NText:f,NP:p,NGrid:m,NGi:y,NButton:v,NDataTable:g,NSpace:h,NConfigProvider:k,NLayout:x,FileExcelOutlinedIcon:N,ReloadPrompt:z},setup(){const t=_(),a=e([]);let n={};const l=e(!1);return{theme:R((()=>"dark"===t.value?B:null)),osTheme:t,columns:[{title:"卡号",key:"key"},{title:"姓名",key:"name"},{title:"部门名称",key:"deptName"},{title:"补贴类型",key:"type"},{title:"补贴金额",key:"amount"}],showJsonTable:l,dataTable:a,handleBeforeUpload:({file:e})=>{const t=new FileReader;t.onload=e=>{var t;const s=null==(t=e.target)?void 0:t.result,o=b.read(s,{type:"binary"}),i=o.Sheets[o.SheetNames[0]],r=b.utils.sheet_to_json(i,{defval:"",header:["key","name","deptName","type","amount"]});n=r.shift(),a.value=r,l.value=!0},t.readAsBinaryString(e.file)},sortByKey:()=>{a.value=w(a.value,(function(e){return Number(e.key)}))},downloadFile:()=>{const e=b.utils.book_new();a.value.unshift(n);const t=b.utils.json_to_sheet(a.value,{skipHeader:!0});return console.log(t["!ref"]),b.utils.book_append_sheet(e,t,"Results"),b.writeFile(e,"1.xls")}}}});const P={style:{"margin-bottom":"12px"}},A=T("点击或者拖动 XLS 文件到该区域来上传"),W=T("请不要上传敏感数据，比如你的银行卡号和密码，信用卡号有效期和安全码"),G=T("排序"),K=T("下载");O.render=function(e,t,a,n,l,r){const d=S("FileExcelOutlinedIcon"),u=S("n-icon"),c=S("n-text"),f=S("n-p"),p=S("n-upload-dragger"),m=S("n-upload"),y=S("n-data-table"),v=S("n-gi"),g=S("n-button"),h=S("n-space"),k=S("n-grid"),x=S("ReloadPrompt"),N=S("n-layout"),_=S("n-config-provider");return s(),o(_,{theme:e.theme},{default:E((()=>[i(N,{position:"absolute"},{default:E((()=>[i(k,{cols:"8 s:8 m:8 l:8 xl:4 2xl:4","y-gap":8,responsive:"screen"},{default:E((()=>[i(v,{offset:"l:2 xl:1 2xl:1",span:"8 s:8 m:8 l:4 xl:2 2xl:2"},{default:E((()=>[e.showJsonTable?(s(),o(y,{key:1,ref:"table",columns:e.columns,data:e.dataTable,"max-height":"70vh","virtual-scroll":""},null,8,["columns","data"])):(s(),o(m,{key:0,accept:".xls","show-file-list":!1,onBeforeUpload:e.handleBeforeUpload},{default:E((()=>[i(p,null,{default:E((()=>[i("div",P,[i(u,{size:"48",depth:3},{default:E((()=>[i(d)])),_:1})]),i(c,{style:{"font-size":"16px"}},{default:E((()=>[A])),_:1}),i(f,{depth:"3",style:{margin:"8px 0 0 0"}},{default:E((()=>[W])),_:1})])),_:1})])),_:1},8,["onBeforeUpload"]))])),_:1}),i(v,{offset:"1 s:1 m:1 l:2 xl:1 2xl:1",span:"6 s:6 m:6 l:4 xl:2 2xl:2"},{default:E((()=>[i(h,{justify:"center"},{default:E((()=>[i(g,{type:"primary",size:"large",onClick:t[1]||(t[1]=t=>e.sortByKey())},{default:E((()=>[G])),_:1}),i(g,{size:"large",onClick:t[2]||(t[2]=t=>e.downloadFile())},{default:E((()=>[K])),_:1})])),_:1})])),_:1})])),_:1}),i(x)])),_:1})])),_:1},8,["theme"])},U(O).mount("#app");
