import{r as e,v as t,n as a,d as l,u as n,o,c as s,a as r,b as i,N as d,e as u,f as c,g as f,h as p,i as y,j as m,k as v,l as g,m as k,F as h,x,p as w,w as R,q as N,s as _,t as b,y as E}from"./vendor.98fe13f6.js";function B(l={}){const{immediate:n=!0,onNeedRefresh:o,onOfflineReady:s,onRegistered:r,onRegisterError:i}=l,d=e(!1),u=e(!1);return{updateServiceWorker:function(e={}){const{immediate:l=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:s,onRegisterError:r}=e;let i,d;if("serviceWorker"in navigator){i=new t("/excel-sort/sw.js",{scope:"/excel-sort/"}),i.addEventListener("activated",(e=>{e.isUpdate||null==o||o()}));{const e=()=>{null==n||n()};i.addEventListener("waiting",e),i.addEventListener("externalwaiting",e)}i.register({immediate:l}).then((e=>{d=e,null==s||s(e)})).catch((e=>{null==r||r(e)}))}return async(e=!0)=>{e&&(null==i||i.addEventListener("controlling",(e=>{e.isUpdate&&window.location.reload()}))),d&&d.waiting&&await a(d.waiting,{type:"SKIP_WAITING"})}}({immediate:n,onNeedRefresh(){d.value=!0,null==o||o()},onOfflineReady(){u.value=!0,null==s||s()},onRegistered:r,onRegisterError:i}),offlineReady:u,needRefresh:d}}const U={key:0,class:"pwa-toast",role:"alert"},F={class:"message"},S={key:0},T={key:1};var I=l({setup(e){const{offlineReady:t,needRefresh:a,updateServiceWorker:l}=B(),d=async()=>{t.value=!1,a.value=!1};return(e,u)=>n(t)||n(a)?(o(),s("div",U,[r("div",F,[n(t)?(o(),s("span",S," App ready to work offline ")):(o(),s("span",T," New content available, click on reload button to update. "))]),n(a)?(o(),s("button",{key:0,onClick:u[1]||(u[1]=e=>n(l)())},"Reload")):i("",!0),r("button",{onClick:d},"Close")])):i("",!0)}}),j=l({name:"App",components:{NUpload:d,NUploadDragger:u,NIcon:c,NText:f,NP:p,NGrid:y,NGi:m,NButton:v,NDataTable:g,NSpace:k,FileExcelOutlinedIcon:h,ReloadPrompt:I},setup(){const t=e([]);let a={};const l=e(!1);return{columns:[{title:"卡号",key:"key"},{title:"姓名",key:"name"},{title:"部门名称",key:"deptName"},{title:"补贴类型",key:"type"},{title:"补贴金额",key:"amount"}],showJsonTable:l,dataTable:t,handleBeforeUpload:({file:e})=>{const n=new FileReader;n.onload=e=>{var n;const o=null==(n=e.target)?void 0:n.result,s=x.read(o,{type:"binary"}),r=s.Sheets[s.SheetNames[0]],i=x.utils.sheet_to_json(r,{defval:"",header:["key","name","deptName","type","amount"]});a=i.shift(),t.value=i,l.value=!0},n.readAsBinaryString(e.file)},sortByKey:()=>{t.value=w(t.value,(function(e){return Number(e.key)}))},downloadFile:()=>{const e=x.utils.book_new();t.value.unshift(a);const l=x.utils.json_to_sheet(t.value,{skipHeader:!0});return console.log(l["!ref"]),x.utils.book_append_sheet(e,l,"Results"),x.writeFile(e,"1.xls")}}}});const C={style:{"margin-bottom":"12px"}},O=b("点击或者拖动文件到该区域来上传"),A=b("请不要上传敏感数据，比如你的银行卡号和密码，信用卡号有效期和安全码"),L=b("排序"),P=b("下载");j.render=function(e,t,a,l,n,i){const d=_("FileExcelOutlinedIcon"),u=_("n-icon"),c=_("n-text"),f=_("n-p"),p=_("n-upload-dragger"),y=_("n-upload"),m=_("n-data-table"),v=_("n-gi"),g=_("n-button"),k=_("n-space"),h=_("n-grid"),x=_("ReloadPrompt");return o(),s(N,null,[r(h,{cols:"8 s:8 m:8 l:8 xl:4 2xl:4","y-gap":8,responsive:"screen"},{default:R((()=>[r(v,{offset:"l:2 xl:1 2xl:1",span:"8 s:8 m:8 l:4 xl:2 2xl:2"},{default:R((()=>[e.showJsonTable?(o(),s(m,{key:1,ref:"table",columns:e.columns,data:e.dataTable,"max-height":"70vh","virtual-scroll":""},null,8,["columns","data"])):(o(),s(y,{key:0,accept:".xls","show-file-list":!1,onBeforeUpload:e.handleBeforeUpload},{default:R((()=>[r(p,null,{default:R((()=>[r("div",C,[r(u,{size:"48",depth:3},{default:R((()=>[r(d)])),_:1})]),r(c,{style:{"font-size":"16px"}},{default:R((()=>[O])),_:1}),r(f,{depth:"3",style:{margin:"8px 0 0 0"}},{default:R((()=>[A])),_:1})])),_:1})])),_:1},8,["onBeforeUpload"]))])),_:1}),r(v,{offset:"1 s:1 m:1 l:2 xl:1 2xl:1",span:"6 s:6 m:6 l:4 xl:2 2xl:2"},{default:R((()=>[r(k,null,{default:R((()=>[r(g,{type:"primary",onClick:t[1]||(t[1]=t=>e.sortByKey())},{default:R((()=>[L])),_:1}),r(g,{onClick:t[2]||(t[2]=t=>e.downloadFile())},{default:R((()=>[P])),_:1})])),_:1})])),_:1})])),_:1}),r(x)],64)},E(j).mount("#app");
